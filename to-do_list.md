# Tex-Machina Extension
## Structure

## 개선이 핑요한 사항
- quickpick을 통한 명령어 입력 시 뜨는 연관 명령어를 모든 기능에 대해 지원해야 함 
- 설정에서 더 많은 커스터마이징이 가능하도록 해야 함 
- 수식 블록 기반 히스토리 : 수식 부분에서 히스토리 기능을 지원해서, 수식에 한정해 git과 같은 수정 내역 관리 시스템을 만들어야 함 

## 추가 예정 기능 
- 수식 자동 분할기 : 안에 너무 긴 수식을 썼을 때, 단축키를 누르면 자동으로 \begin{align}으로 변환되며 가장 바깥쪽 스코프의 = 나 + 기호를 찾아 자동으로 \\ &를 삽입하여 줄바꿈과 정렬을 해줌 
- 편리한 단위 입력 : 물리/공학 논문 필수 패키지인 siunitx를 쓸 때, 귀찮게 \SI{10}{\kilo\gram\meter\per\second\squared}라고 치지 않아도 되는 기능. 그냥 \SI{10kgm/s^2} 라고 대충 치고 포맷팅 단축키를 누르면 규격에 맞는 매크로로 자동 확장(컴파일)해 주는 기능
- webview : 사용하지 않는 경우 webview 화면이 비어 있는 문제가 있음. 기본값으로 webview에 유용한 기능이 있도록 만들 것
- 편리한 테이블 생성 : 워드의 table 생성 기능을 참고 
- 과학 상수 입력 기능 : 플랑크 상수 등을 간단히 넣을 수 있는 기능 
- Label이 달린 내용이 변경되었을 시 알림 기능 : 참조가 일어난 Label의 수식, 정리의 내용이 수정되거나, label 이름이 수정되었을 때, 알림을 하는 기능 
- Label 이름 추천 기능
- Label 해시태그 기능 : 특정 라벨에 해시태그를 달아두면, \ref를 할 때 해당 라벨의 해시태그를 입력해서 바로 서치할 수 있도록 함. 이는 parse.py의 프론트엔드와 결합해도 좋을 듯 
- 스마트 첨자 자동 괄호 (Auto-bracing for Sub/Superscripts): 수식에서 _나 ^ 뒤에 두 글자 이상을 치면 자동으로 {}로 묶어주는 기능 
- 수식 모드 자동 전환 : 일반 텍스트 모드에서 \alpha나 \sum 같은 수학 전용 매크로를 타이핑하면, 에디터가 이를 감지하고 자동으로 양옆에 $ $를 씌워줌 (예: Let \alpha -> Let $\alpha$)
- Latex environment 자동 삭제 : \begin{itemize}를 지우면 쌍을 이루는 \end{itemize}가 동시에 삭제되는 기능
- 마크다운과 Latex : 마크다운처럼 **텍스트**를 치고 스페이스를 누르면 \textbf{텍스트}로 변환되고, -(하이픈+스페이스)를 치면 자동으로 \begin{itemize} \item ... 환경으로 바꿔줌
- item 스와프 : \item 목록을 작성하다가 순서를 바꾸고 싶을 때, 커서를 두고 Alt + Up/Down을 누르면 해당 아이템의 여러 줄에 걸친 내용 전체가 위/아래 아이템과 통째로 자리를 바꿔줌 
- 미사용된 패키지 감지 : 한 번도 쓰인 적 없는 패키지는 자동으로 주석 처리가 되고, 이후 사용이 일어나면 주석 처리가 해제됨 
- 미사용된 label 감지 : 논문 전체를 스캔하여 \label{...}을 달아놓고 단 한 번도 \ref{}나 \cite{}로 호출하지 않은 '죽은 라벨'들을 찾아 회색으로 흐리게 표시합니다. 원클릭으로 일괄 삭제하여 코드를 깔끔하게 만듭니다.
- 스마트 따옴표 : 키보드의 " (큰따옴표) 키를 누르면, LaTeX 문법에 맞게 열 때는 ````(백틱 2개), 닫을 때는 ''(작은따옴표 2개)로 알아서 번갈아 가며 입력됩니다. 단, `\begin{verbatim}` 환경이나 코드 블록 안에서는 원래대로 `"` 가 입력됩니다.
- 다이어크리틱 입력 : 글자 a를 치고 Alt + ^ 를 누르면 \hat{a}로, Alt + ~ 를 누르면 \tilde{a}로, Alt + . 을 누르면 \dot{a}로 커서를 감싸며 즉시 변환되는 기능. 맥에서는 alt 대신 option키를 이용함. 

### Calc
- 역행렬/행렬 분해 자동 시각화 (Matrix Decompositions): 행렬을 드래그하고 matrix > decomp >[lu/qr/svd/cholesky]를 입력하면, 행렬이 A = L U A=LU 형태로 분해된 두 개의 LaTeX 행렬 코드로 분할되어 문서에 삽입됩니다.
### Plot 
- matplotlib으로 그래픽을 생성할 경우 현재 x3dom에서 보던 시점이나 속성을 적용하도록 바꿨으면 좋을 것 같음.
### Macro 
- 컨텍스트 인지 (Context-Aware) 매크로: 현재 커서가 수학 모드($...$, \[...\]) 내부인지, 일반 텍스트 모드인지 감지하여 동일한 단축어라도 다른 동작을 하게 설정하는 기능. 
- 명령어 체이닝 (Chaining): 여러 메인 커맨드를 연결하는 기능. 예: calc > diff && plot > 2d (미분한 결과를 바로 그래프로 그리기).
    * > define:명령어체인>:이름 형태로 저장, ;이름 으로 호출.
- 키스트로크 레코딩 및 재생 속도 조절 지원.
- 수식 노드(Node) 네비게이션: 단축키(예: Alt + 방향키)를 누르면 커서가 단순히 글자 단위로 이동하는 게 아니라, 분자 → 분모 → 적분 기호 내부 → 괄호 내부 등 수학적 계층에 따라 점프합니다.
    - 빠른 이동 : 작동 방식: \frac{A}{B}의 A 위치에 커서를 두고 [구조적 다음 선택] 단축키를 누릅니다.
- 스마트 검색 : 확장 프로그램 내에 쿼리 명령어를 제공하는 기능. 예를 들어 ```'figure > \includegraphics:not([alt])').inject('alt={}'```를 입력 시 문서 전체를 스캔해서, figure 환경 안에 있으면서 alt 속성이 없는 모든 \includegraphics를 찾아 자동으로 빈 alt={} 괄호를 찔러 넣는 기능 
결과: 문서 아래에 있는 \frac{x^2}{y}의 x^2, \frac{123}{456}의 123 등, 텍스트 내용은 다르지만 "분수의 첫 번째 인자(분자)"라는 구조적 위치가 같은 곳에만 멀티 커서가 차례대로 찍힙니다.
- 스마트 로컬 리팩토링 (Scope Rename): 문서 전체에서 x를 \xi로 바꾸는 찾기/바꾸기는 위험하므로 특정 \begin{equation} ... \end{equation} 블록이나 현재 커서가 있는 문단 내에서만 변수를 안전하게 이름 변경(Rename)하는 기능. 
- 자동 수식 정렬 (Auto-Aligner): 더럽게 작성된 여러 줄의 수식을 드래그하고 macro > align을 치면, 가장 큰 등호(=)나 부등호를 기준으로 \begin{align*} ... \end{align*} 코드로 자동 변환하고 여백을 예쁘게 정렬해 줌 
- 매크로 미리보기 : 매크로 실행 시 예상 코드를 회색으로 미리 보여주는 기능 


### Cite
### Ref Graph
#### Frontend
- 미분방정식의 경우 step 1, 2 자세도까지만 지원함. 추후 추가 예정
### Formular search
- OEIS 수열 검색 api 테스트
- 데이터베이스 json 파일에서 search를 하는 python core의 개발이 필요함. 노테이션이 달라도 검색이 되도록 해야 함.
- 유저 피드백 기능 : 검색이 되지 않는 경우 제보를 하면 관리자가 추후 추가 




## 고쳐야 할 버그
- plot 2d 기능이 작동하지 않고 있음
- math_formulas.json의 수식 부분이 정상적인 latex 포맷이 아님을 발견
- 행렬 입력 시 엔터로 자동완성을 해 커맨드를 작성할 경우 행렬의 내용을 입력 하더라도 다시 자동완성 시점으로 되돌아가는 버그가 있음. 
    > Ex : matrix > 를 입력 후 엔터로 matrix > b를 자동완성한 후, matrix > b > 1, 2 / 3, 4 를 입력하고 엔터를 누르면 다시 matrix > b로 롤백되는 현상
    - 해당 현상은 직접 명령어를 타이핑 하는 경우 발견되진 않음

- Webview에 보이는 수식의 렌더링이 좀 이상함. 행렬의 대괄호가 내부 내용의 크기에 맞춰 길어지지 않고 기본 크기 그대로임.

